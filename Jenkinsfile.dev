pipeline {
    agent any

    environment {
        GCLOUD_SDK_PATH = '/root/google-cloud-sdk'
    }

    stages {
        stage('Configurar gcloud') {
            steps {
                script {
                    // Verificar si gcloud está instalado en la ubicación esperada
                    def gcloudInstalled = fileExists("${GCLOUD_SDK_PATH}/bin/")

                    if (!gcloudInstalled) {
                        error "¡gcloud no está instalado en la ubicación esperada!"
                    }

                    // Asegurarse de que gcloud esté en el PATH y ejecutar gcloud en el mismo bloque de shell
                    sh """
                    export PATH=\$PATH:${GCLOUD_SDK_PATH}/bin
                    gcloud --help
                    """
                }
            }
        }
    }
}
